<%- include("partials/header"); -%>
    <div id="preloader">
        <div class="wrapper">
            <div class="static-txt">
                <ul class="dynamic-txts">
                    <li><span><p>बोलता है रिपोर्टर...</p></span></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- Page header with logo and tagline-->
    <div class="news red full-width">
        <span>Breaking News</span>
        <ul class="scrollLeft">
            <% posts.forEach(function(post) { %>
            <li><a href="/posts/<%= post._id %>"><%= post.title %></a></li>
            <% }); %>
        </ul>
    </div>
    <!-- Page content-->
    <div class="container">
        <div class="row">
            <!-- Blog entries-->
            <div class="/col-lg-8">
                <!-- Featured blog post-->
                <!-- <div class="card mb-4">
                    <a href="#!"><img class="card-img-top" src="https://dummyimage.com/700x350/dee2e6/6c757d.jpg" alt="..." /></a>
                                    <div class="card-body">
                                        <div class="small text-muted">January 1, 2022</div>
                                        <h2 class="card-title h4">Post Title</h2>
                                        <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reiciendis aliquid atque, nulla.</p>
                                        <a class="btn btn-primary" href="#!">Read more →</a>
                                    </div>
                    </div>
                </div> -->
                <!-- Nested row for non-featured blog posts-->
                <div class="row">
                    <div class="/col-lg-6">
                        <!--- Blog post-->
                        <!-- <div class="card mb-4">
                                    <a href="#!"><img class="card-img-top" src="https://dummyimage.com/700x350/dee2e6/6c757d.jpg" alt="..." /></a>
                                    <div class="card-body">
                                        <div class="small text-muted">January 1, 2022</div>
                                        <h2 class="card-title h4">Post Title</h2>
                                        <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reiciendis aliquid atque, nulla.</p>
                                        <a class="btn btn-primary" href="#!">Read more →</a>
                                    </div>
                                </div> -->
                        <!-- Blog post-->
                        <% posts.forEach(function(post) { %>
                            <div class="/card mb-4">
                                <a href="/posts/<%= post._id %>"><img class="card-img-top" src="<%= post.imgLink %>" alt="..." /></a>
                                <div class="card-body">
                                    <div class="small text-muted">
                                        <%= post.date %>
                                    </div>
                                    <h2 class="card-title h4">
                                        <%= post.title %>
                                    </h2>
                                    <p class="card-text">
                                        <%- (post.content.substring(0, 250) + "..."); %>
                                    </p>
                                    <p class="card-text">
                                        <div class="author"><p>Author: <%= post.author %></p></div>
                                    </p>
                                    <a class="btn btn-primary" href="/posts/<%= post._id %>">Read more →</a>
                                </div>
                            </div>
                            <% }); %>
                    </div>
                    <!-- <div class="col-lg-6"> -->
                    <!-- Blog post-->
                    <!-- <div class="card mb-4">
                                    <a href="#!"><img class="card-img-top" src="https://dummyimage.com/700x350/dee2e6/6c757d.jpg" alt="..." /></a>
                                    <div class="card-body">
                                        <div class="small text-muted">January 1, 2022</div>
                                        <h2 class="card-title h4">Post Title</h2>
                                        <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reiciendis aliquid atque, nulla.</p>
                                        <a class="btn btn-primary" href="#!">Read more →</a>
                                    </div>
                                </div> -->
                    <!-- Blog post-->
                    <!-- <div class="card mb-4">
                                    <a href="#!"><img class="card-img-top" src="https://dummyimage.com/700x350/dee2e6/6c757d.jpg" alt="..." /></a>
                                    <div class="card-body">
                                        <div class="small text-muted">January 1, 2022</div>
                                        <h2 class="card-title h4">Post Title</h2>
                                        <p class="card-text">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reiciendis aliquid atque, nulla? Quos cum ex quis soluta, a laboriosam.</p>
                                        <a class="btn btn-primary" href="#!">Read more →</a>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                    <!-- Pagination-->
                    <!-- <nav aria-label="Pagination">
                        <hr class="my-0" />
                        <ul class="pagination justify-content-center my-4">
                            <li class="page-item disabled"><a class="page-link" href="#" tabindex="-1" aria-disabled="true">Newer</a></li>
                            <li class="page-item active" aria-current="page"><a class="page-link" href="#!">1</a></li>
                            <li class="page-item"><a class="page-link" href="#!">2</a></li>
                            <li class="page-item"><a class="page-link" href="#!">3</a></li>
                            <li class="page-item disabled"><a class="page-link" href="#!">...</a></li>
                            <li class="page-item"><a class="page-link" href="#!">15</a></li>
                            <li class="page-item"><a class="page-link" href="#!">Older</a></li>
                        </ul>
                    </nav> -->
                </div>
                <!-- Side widgets-->
                <div class="/col-lg-4">
                    <!-- Search widget-->
                    <!-- <div class="card mb-4">
                    <div class="card-header">Search</div>
                    <div class="card-body">
                        <div class="input-group">
                            <input class="form-control" type="text" placeholder="Enter search term..." aria-label="Enter search term..." aria-describedby="button-search" />
                            <button class="btn btn-primary" id="button-search" type="button">Go!</button>
                        </div>
                    </div>
                </div> -->
                    <!-- Categories widget-->
                    <!-- <h2>WorldWide News</h2>
                    <div class="card mb-4">
                        <div class="card-header">Categories</div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-6">
                                    <ul class="list-unstyled mb-0">
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="0">National</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="1">Business</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="2">Sport</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="3">World</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="4">Politics</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="5">Technology</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-6">
                                    <ul class="list-unstyled mb-0">
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="6">Startup</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="7">Entertainment</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="8">Miscellaneous</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="9">Hatke</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="10">Science</a></li>
                                        <li><a onclick="sendCategory(this.id)" href="#!" id="11">Automobile</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- Side widget-->
                    <!-- <div class="card mb-4">
                        <div class="card-header">Top 2 Trending News from other sources.</div>
                        <div class="card-body">
                            <div id="newsBox" class="container"></div>
                            <div id="spinner" class="mySpin spinner-border text-warning"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            let newsBox = document.getElementById('newsBox');
            let spinner = document.getElementById('spinner');
            let newsCateogry = ['national', 'business', 'sports', 'world', 'politics', 'technology', 'startup', 'entertainment', 'miscellaneous', 'hatke', 'science', 'automobile'];
            // Create XML Object
            const xhr = new XMLHttpRequest();

            function sendCategory(index) {
                getNews(newsCateogry[index])
            }
            getNews("all");

            function getNews(newsCateogryName) {
                xhr.open('GET', `https://inshorts.deta.dev/news?category=${newsCateogryName}`, true);

                xhr.getResponseHeader('Content-type', 'application/json');

                xhr.onload = function() {
                    // status code 200 is For "OK"
                    if (this.status === 200) {
                        let json = JSON.parse(this.responseText);
                        let data = json.data; // Get data Oblect
                        // console.log(data);
                        let newsHTML = "";

                        function showSpinner() {
                            spinner.style.visibility = 'hidden';
                            newsBox.style.visibility = 'visible';
                        }

                        xhr.onprogress = showSpinner();

                        //Applying Loop on data to get inner elements
                        for (key in data) {

                            let news = `<div class="newsCard card">
                            <img src="${data[key].imageUrl}"
                                class="img ard-img-top img-thumbnail" alt="Image">
                            <h2 class="card-header">${data[key].title}</h2>
                            <div class="card-body">
                                <h5 class="card-title">Author: ${data[key].author}</h5>
                                <p class="card-text">${data[key].content}</p>
                                <a target="_blank" href="${data[key].readMoreUrl}" class="btn btn-primary">Read more..</a>
                            </div>
                           <div class="text-center card-footer text-muted">${data[key].date}</div>
                           <hr class="line">
                        </div>`;
                            newsHTML += news;
                        }
                        // Manuplating DOM
                        newsBox.innerHTML = newsHTML;
                    } else {
                        console.log("Some Error Occured");
                    }
                }

                xhr.send(); // This is important to run whole code

            }
        </script> -->
                    <%- include("partials/footer"); -%>
                    <script>
                        var loader = document.getElementById("preloader");
                        window.addEventListener("load", function () {
                            loader.style.display = "none";
                        });
                    </script>